<div>
    <form id="chat-{{.ChatId}}-msg-form"
        hx-post="/message" 
        hx-trigger="submit" 
        hx-target=".message-list" 
        hx-swap="beforeend"
        hx-include="[name='chatid'],[name='msg'],[name='quoteId']"
        class="flex flex-col ml-auto mt-auto p-auto max-w-[80%]"
    >
        <input type="hidden" name="chatid" value="{{ .ChatId }}">
        <input id="chat-{{.ChatId}}-msg-text-input" type="text" name="msg" 
            placeholder="type message" 
            title="enter to send"
            class="w-full
            text-center
            bg-gradient-to-br from-green-800 to-indigo-800
            text-gray-400
            shadow shadow-zinc-700
            border-2 rounded border-emerald-400
            hover:shadow-lg hover:shadow-zinc-500">
        <button type="submit" class="hidden">
            Send Message
        </button>
    </form>
    <script>
        document.body.addEventListener('htmx:afterSwap', event => {
            const newMsgText = document.getElementById('chat-{{.ChatId}}-msg-text-input');
            if (newMsgText) {
                newMsgText.value = '';
            }
           
            // clear any active quotes on any chage in chat
            // it works for 2 reasons:
            // 1. embeded script is local to the file
            // 2. there aren't too many event sources in scope
            if (event.target.id !== 'chat-{{.ChatId}}-msg-form') {
                console.log('69696969', event)
                setTimeout(() => {
                    const quotes = document.querySelectorAll(`.quote-chat-message`);
                    for (i = 0; i < quotes.length; i++) {
                        quotes[i].remove();
                    }
                }, 100);     
            }
        });
    </script>
</div>